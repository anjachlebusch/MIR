{% extends "main_page.html" %}
{% block body %}
<div class="container" style="margin-top:10px">
  <!-- Left info bar -->
  <div class="row">
    <div class="col-sm-2">
      <h3>Overview</h3>
      <!--<p>Optional info here.</p>-->
      <ul class="nav nav-pills flex-column">
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('index') }}">Select image</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="#">Query results</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Settings</a>
        </li>
      </ul>
      <hr class="d-sm-none">
    </div>

    <div class="col-sm-9">
      <h1 class="page-header">Input image</h1>
      {%for image,info in zipped_input %}
      <img src="{{url_for('static', filename='images/query/'+ image)}}" width="500" height="500">
      <!-- TODO: for -->
      {%endfor%} 
      <h1 class="page-header">Query results</h1>

      <table style="margin-left: 20px;">
        <!-- Table headers -->
            <th>
                <tr style="color: green; ">    
                <td>Image</td>
                <td>Imagename</td>
                <td>Distance</td>
                <td>IrmaCode</td>
                <td>IrmaInfo</td>
        </tr>
            </th>
    
      {%for image,distance,code,info in zipped_results %}

        <tr>
          <td><div class="notSelected" style="width:300; height:300;" onclick="click_on_image(this)"><img src= "{{url_for('static', filename='images/database/ImageCLEFmed2007_training/imageclef2007med_training/'+ image)}}" width="300" height="300" onerror=alert(image)></div><div style="height:20px"></div></td>
          <td>{{image}}</td>  
          <td>{{distance}}</td>
          <td>{{code}}</td>
          <td>{{info}}</td>
        
      {%endfor%} 
      </tr>

        
      
      </table>


      <div style="height: 200px"></div>
      <div class="text-center" style="text-align:center">
        <form id="add_new_page" action="{{ url_for('new_page') }}" method="POST" enctype="multipart/form-data">
          <button type="submit" class="btn btn-primary" id="load_more" onclick="activate_spinner(this)"
            style="visibility:hidden">Load more...</button>
        </form>
      </div>
      <div style="height: 50px"></div>
    </div>
    <div class="col-">
      <div class="text-right" style="position: fixed">
        <button type="submit" class="btn btn-primary" id="relevance_feedback"
          onclick="activate_spinner(this);relevance_feedback()" style="visibility:hidden">Relevance feedback!</button>
      </div>
    </div>
  </div>
</div>
</body>

<script>
  // function to select/deselect images
  function click_on_image(element) {
    if (element.className=="selected"){
      element.className="notSelected";
      element.style.border= "0px solid #555";
    }
    else{
      element.className="selected";
      element.style.border= "5px solid #555";
    }
    
  }


  function relevance_feedback() {
    fetch('/relevance_feedback', {

      // TODO:
    });
  }

  // function which is called when you're at the bottom of the page
  window.onscroll = function (ev) {
    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
      document.getElementById("load_more").style.visibility ="visible";
    }
  };

</script>

</html>
{% endblock %}